<!DOCTYPE html>
<html lang="en">
   <head>
      <meta charset="UTF-8">
      <meta name="viewport" content="width=device-width, initial-scale=1.0">
      <title>Admin courses</title>
      <link rel="stylesheet" href="/fontawesome/css/all.min.css">
      <link rel="stylesheet" href="/adminlte/dist/css/adminlte.min.css">
   </head>
   <body class="layout-fixed sidebar-expand-lg bg-body-tertiary">
      <!--begin::App Wrapper-->
      <div class="app-wrapper">
         <!--begin::Header-->
         <nav class="app-header navbar navbar-expand bg-body"  style="min-height: 50px;">
            <!--begin::Container-->
            <div class="container-fluid">
               <!--begin::Start Navbar Links-->
     
               <!--end::End Navbar Links-->
            </div>
            <!--end::Container-->
         </nav>


         <!--end::Header--> <!--begin::Sidebar-->
         <aside class="app-sidebar bg-body-secondary shadow" data-bs-theme="dark">
            <!--begin::Sidebar Brand-->
            <div class="sidebar-brand">
               <!--begin::Brand Link--> 
               <a href="/courses" class="brand-link">
                    <span class="brand-text fw-light">AdminLTE 4</span> <!--end::Brand Text--> 
               </a>
               <!--end::Brand Link--> 
            </div>
            <!--end::Sidebar Brand--> <!--begin::Sidebar Wrapper-->
            <div class="sidebar-wrapper">
               <nav class="mt-2">
                  <!--begin::Sidebar Menu-->
                  <ul class="nav sidebar-menu flex-column" data-lte-toggle="treeview" role="menu" data-accordion="false">
                     <li class="nav-item">
                        <a href="/courses" class="nav-link">
                           <i class="nav-icon bi bi-speedometer"></i>
                           <p>
                              courses
                              <i class="nav-arrow bi bi-chevron-right"></i>
                           </p>
                        </a>
                     </li>
                     <li class="nav-item">
                        <a href="/courses/new" class="nav-link">
                           <i
                              class="nav-icon bi bi-palette"></i>
                           <p>add course</p>
                        </a>
                     </li>
                  </ul>
                  <!--end::Sidebar Menu-->
               </nav>
            </div>
            <!--end::Sidebar Wrapper-->
         </aside>

         
         <!--end::Sidebar--> <!--begin::App Main-->
         <main class="app-main">
            <!--begin::App Content Header-->
            <div class="app-content-header">
               <!--begin::Container-->
               <div class="container-fluid">
                  <!--begin::Row-->
                  <div class="row">
                     <div class="col-sm-6">
                        <h3 class="mb-0">All Courses</h3>
                     </div>
                     <div class="col-sm-6">
                        <ol class="breadcrumb float-sm-end">
                           <li class="breadcrumb-item"><a href="#">Home</a></li>
                           <li class="breadcrumb-item active" aria-current="page">
                              All Courses
                           </li>
                        </ol>
                     </div>
                  </div>
               </div>
            </div>
            <div class="app-content">
               <!--begin::Container-->
               <div class="container-fluid">
                  <!--begin::Row-->
                  <div class="row g-4">
                     <!--begin::Col-->
                     <div class="col-md-12">
                        <!--begin::Quick Example-->
                        <div class="card card-primary card-outline mb-4">
                           <div class="card-header">
                              <div class="card-title" style="width: 100%;">All Courses:  <a href="/courses/new" class="btn btn-primary mb-3" style="float: right;">Add New Course</a></div>
                           </div>
                           <!--end::Header--> <!--begin::Form-->
                           <table class="table table-striped">
                             <thead>
                               <tr>
                                 <th>Name</th>
                                 <th>Description</th>
                                 <th>Tags</th>
                                 <th>Price</th>
                                 <th>Author</th>
                                 <th>Actions</th>
                               </tr>
                             </thead>
                             <tbody>
                               <% courses.forEach(course => { %>
                                 <tr>
                                   <td><%= course.name %></td>
                                   <td><%= course.desc %></td>
                                   <td><%= course.tags.join(', ') %></td>
                                   <td><%= course.price %></td>
                                   <td><%= course.author.name %></td>
                                   <td>
                                    <a href="/courses/<%= course._id %>" class="btn btn-info">View</a>
                                    <a href="/courses/<%= course._id %>/edit" class="btn btn-warning">Update</a>
                                    <button class="btn btn-danger" onclick="deleteCourse('<%= course._id %>')">Delete</button>
                                   </td>
                                 </tr>
                               <% }) %>
                             </tbody>
                           </table>
                           <!--end::Form-->
                        </div>
                     </div>
                     <!--end::Col--> <!--begin::Col-->
                  </div>
                  <!--end::Row-->
               </div>
               <!--end::Container-->
            </div>
            <!--end::App Content-->
         </main>


         <!--end::App Main--> <!--begin::Footer-->
         <footer class="app-footer">
            <div class="float-end d-none d-sm-inline">Anything you want</div>
            <strong>
            Copyright &copy; 2014-2024&nbsp;
            <a href="https://adminlte.io" class="text-decoration-none">AdminLTE.io</a>.
            </strong>
            All rights reserved.
         </footer>
      </div>
      <script src="/adminlte/dist/js/adminlte.min.js"></script>

      <script>
         function deleteCourse(courseId) {
           if (confirm('Are you sure you want to delete this course?')) {
             fetch(`/courses/${courseId}`, {
               method: 'DELETE'
             })
             .then(response => {
               if (response.ok) {
                 window.location.reload();  // Reload the page to reflect changes
               } else {
                 alert('Failed to delete the course');
               }
             })
             .catch(error => {
               console.error('Error:', error);
             });
           }
         }
       </script>
   </body>
</html>